<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>PANAPP</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript">
    var contadorCarrito=0;
    var productos = ["Barra Rustica", "Barra de picos", "Chapata", "Torta de Aranda","Baguette","Tarta de Santiago","Tarta de tres chocolates", "Tarta Red Velvet", "Tarta de zanahoria", "Tarta de queso", "Empanada de atun", "Empanada de pollo", "Empanada de jamon y queso", "Empanada vegana", "Empanada de bacalao"];
    var imgGrandes = ["Rustica1.png","Picos2.png", "Chapata3.jpg","Torta4.jpg","Baguette5.png","Santiago6.jpg", "TresChocolates7.png", "RedVelvet8.png", "CarrotCake9.jpg", "Queso10.jpg", "Atun11.jpg", "Pollo12.jpg", "JamonQueso13.jpg", "Vegana14.jpg", "Bacalao15.jpg"];
    var descripcion = ["Ingredientes: harina, levadura y sal. Apto para celiacos ", "Ingredientes: harina, levadura y sal. Apto para celiacos ","Ingredientes: harina, levadura y sal. Apto para celiacos ","Ingredientes: harina, levadura y sal. Apto para celiacos ","Ingredientes: harina, levadura y sal. Apto para celiacos "];
	var precios = [16, 5,100,20,1, 4,5,8,10,11,15,13,14,10,15];
    var ofertas = [50, 20,10,30,15, 2,4,0,0,0,0,0,0,0,0];
    var preciofactura=0;
    var conoferta=[7];
    for(var i=0;i<precios.length;i++)
        conoferta[i]=precios[i]-precios[i]*ofertas[i]/100;
    var carrito=new Object();
    
function obtenerNombre(i){
      var contador=0;
        var oferta;
        var auxiliar=i.getAttribute("id");
        auxiliar=auxiliar.slice(8);
       // alert(auxiliar);
        var variable=document.getElementById('headermodal').innerHTML=productos[auxiliar];
        variable=document.getElementById('parrafo2').innerHTML=descripcion[auxiliar];
        oferta="El precio es "+conoferta[auxiliar]+"€";
        document.getElementById('precio1').innerHTML=oferta;
        
    }

  function enviardatos(){
        var carritofinal=jQuery.makeArray(carrito);
        var enviar=(JSON.stringify(carritofinal));
        localStorage.setItem("carrocompra",enviar);
      //alert(enviar);
      
    }
  
function anadircarrito(nombre,cantidad){
        var j=0;
        var p;
        for(j;j<productos.length && productos[j]!=nombre;j++);
        var precio=conoferta[j];
         var sinespacios=nombre.replace(/ /g,"-");
       // alert(sinespacios);
        var table=document.getElementById("tablaTotal");
        if(carrito[nombre]==undefined){
            carrito[nombre]={"nombre": productos[j], "cantidad": cantidad, "precioproducto":precio, "precioporcantidad":precio*cantidad};
            var fila=table.insertRow(0);
            fila.id="carrito"+contadorCarrito;
            var columna = fila.insertCell(0);
            columna.id="producto"+nombre;
            columna.className="carrodecompra";
            columna.innerHTML+="<b  data-indice=\""+sinespacios+"\">Producto: "+productos[j]+".</b><br>Precio por producto: "+precio+"€.<br>Cantidad:"+cantidad+" unidades.<br>Precio total: "+cantidad*precio+"€";
            columna.innerHTML+="<br><a href='#close' style='position: relative;right: -90%;' onclick='eliminarcarrito(this);'>Eliminar</a>";
            contadorCarrito++;
            preciofactura=preciofactura + cantidad*precio;
             
        }
        else   {
            carrito[nombre].cantidad=parseInt(carrito[nombre].cantidad)+parseInt(cantidad);
            carrito[nombre].precioporcantidad=parseInt(precio*carrito[productos[j]].cantidad);
            var column=document.getElementById("producto"+nombre);
            //alert(column);
            if(contadorCarrito>0)
            var eliminar="carrito"+(contadorCarrito-1);
            else
            var eliminar="carrito"+(contadorCarrito);
           // alert(eliminar);
            column.innerHTML="<b data-indice=\""+sinespacios+"\">Producto: "+nombre+".</b><br>Precio por producto: "+precio+"€.<br>Cantidad:"+carrito[nombre].cantidad+" unidades.<br>Precio total: "+carrito[nombre].precioporcantidad+"€<br><a href='#close' style='position: relative;right: -90%;' onclick='eliminarcarrito(this);'>Eliminar</a>";
            preciofactura=preciofactura+cantidad*precio;
        
            
        }
        
         p=document.getElementById('Facturafinal');
        if(preciofactura<0)
            preciofactura=0;
         p.innerHTML="El precio total es: "+preciofactura;
    }
    
    
function eliminarcarrito(puntero){
    var a = puntero.parentElement;
    var b;
    var tr;
    contadorCarrito--;
    var producto=document.getElementById(a.id).firstChild.dataset.indice;
    producto=producto.replace(/-/g," ");
    b=document.getElementById("producto"+producto);
    tr=b.parentElement;
    tr.removeChild(b);
    //alert(carrito[producto].nombre);
    preciofactura=parseInt(preciofactura-carrito[producto].precioporcantidad);
    var p=document.getElementById('Facturafinal');
    p.innerHTML="El precio total es: "+preciofactura;
    carrito[producto]=undefined; 
       
        if(contadorCarrito<0)
            document.getElementById('Finalizarcompra').style.display='none';
        document.getElementById('Facturafinal');p.innerHTML="El precio total es: "+preciofactura;
    }
     
 </script>

<script type="text/javascript">
    var aux;
    window.onload=function(){
    var IMGS=document.getElementsByClassName("product-image");
    var PRODUCTOS=document.getElementsByClassName("product-content");
    for(i in productos){    
        aux=parseInt(i);
        var imagenfinal= "<img class=\"pic-1\" src=\""+imgGrandes[i]+"\" >";
        var sinrebaja="<span class=\"product-new-label\">Oferta</span> <span class=\"product-discount-label\">"+ofertas[i]+"%</span>";
        IMGS[i].innerHTML=imagenfinal;
        if(ofertas[i]!=0)
            IMGS[i].innerHTML=IMGS[i].innerHTML+sinrebaja;
        var nombre="<h3 class=\"title\"  data-puntero=\""+i+"\"><a href=\"#openModal\" id=\"Producto"+(aux)+"\" onclick=\" obtenerNombre(this);\">"+productos[i]+"</a></h3>";
        PRODUCTOS[i].innerHTML=nombre;
        var rebaja="<div class=\"price\">€"+conoferta[i]+"<span>"+precios[i]+"€</span></div>";
        sinrebaja="<div class='price'>€"+precios[i]+"</div>";
        if(ofertas[i]!=0)
            PRODUCTOS[i].innerHTML=PRODUCTOS[i].innerHTML+rebaja;
        else
            PRODUCTOS[i].innerHTML=PRODUCTOS[i].innerHTML+sinrebaja;
    }
   
    }
</script>

<link rel="stylesheet" href="shopping_grid.css" />
<style>
@import url('https://fonts.googleapis.com/css?family=Montserrat');
</style>
    </head>
    <h3 class="h3">PanAPP </h3>
    <div id="openModal" class="modalDialog">
        <div style="font-family:Montserrat">
            <div>
            <a href="#close" title="Close" class="close" onclick="document.getElementById('cantidades').value = 1;">X</a>
            <div id="headermodal" style="font-family:Montserrat;text-align: center"><h></h></div>
            <p id="parrafo2" style="font-family: Montserrat"></p>
            <p id="precio1" style="font-family: Montserrat"></p>
            </div>
        Cantidad: <input type="number" value="1" min="1" name="cantidades" id="cantidades">
        <a href="#close" onclick="document.getElementById('cantidades').value = 1;"><ul style="padding-inline-start:0px;"><button type="button" class="buttonAddtocart" onclick="
            var comprar=document.getElementById('headermodal').innerHTML;var cantidad=document.getElementById('cantidades');
            anadircarrito(comprar,cantidad.value);if(contadorCarrito>0)document.getElementById('Finalizarcompra').style.display='block';">Añadir al Carrito <img src="MetaforaCarrito.png" width="20" height="20" ></button>
            </a>
            <!--<button type="button" class="buttonAddtocart">     Comprar     </button>--></ul>
	</div>
   
</div>


<div class="container">
    <div class="container2">
        <div class="product-grid" id="Producto1">
            <div class="product-image" id='Imagen1'>
                <span class="product-new-label">Oferta</span>
                <span class="product-discount-label">20%</span>
            </div>
            <div class="product-content" id='Contenido1'>
                <div class="price">$16.00
                    <span>$20.00</span>
                </div>
                <a class="add-to-cart" href="">+ Add To Cart</a>
            </div>
        </div>
        <div class="product-grid" id="Producto2">
            <div class="product-image" id="Imagen2">
                <span class="product-new-label">Oferta</span>
                <span class="product-discount-label">50%</span>
            </div>
            <div class="product-content">
                <div class="price">$5.00
                    <span>$10.00</span>
                </div>
                <a class="add-to-cart" href="">+ Add To Cart</a>
            </div>
        </div>

        <div class="product-grid" id="Producto3">
            <div class="product-image" id='Imagen3'>
                <span class="product-new-label">Oferta</span>
                <span class="product-discount-label">20%</span>
            </div>
            <div class="product-content" id='Contenido1'>
                <div class="price">$16.00
                    <span>$20.00</span>
                </div>
                <a class="add-to-cart" href="">+ Add To Cart</a>
            </div>
        </div>

        <div class="product-grid" id="Producto4">
            <div class="product-image" id='Imagen4'>
                <span class="product-new-label">Oferta</span>
                <span class="product-discount-label">20%</span>
            </div>
            <div class="product-content" id='Contenido1'>
                <div class="price">$16.00
                    <span>$20.00</span>
                </div>
                <a class="add-to-cart" href="">+ Add To Cart</a>
            </div>
        </div>


        <div class="product-grid" id="Producto5">
            <div class="product-image" id='Imagen5'>
                <span class="product-new-label">Oferta</span>
                <span class="product-discount-label">20%</span>
            </div>
            <div class="product-content" id='Contenido1'>
                <div class="price">$16.00
                    <span>$20.00</span>
                </div>
                <a class="add-to-cart" href="">+ Add To Cart</a>
            </div>
        </div>
        <div class="product-grid" id="Producto6">
            <div class="product-image" id='Imagen6'>
                <span class="product-new-label">Oferta</span>
                <span class="product-discount-label">20%</span>
            </div>
            <div class="product-content" id='Contenido1'>
                <div class="price">$16.00
                    <span>$20.00</span>
                </div>
                <a class="add-to-cart" href="">+ Add To Cart</a>
            </div>
        </div>

        <div class="product-grid" id="Producto7">
            <div class="product-image" id='Imagen7'>
                <span class="product-new-label">Oferta</span>
                <span class="product-discount-label">20%</span>
            </div>
            <div class="product-content" id='Contenido1'>
                <div class="price">$16.00
                    <span>$20.00</span>
                </div>
                <a class="add-to-cart" href="">+ Add To Cart</a>
            </div>
        </div>
        <div class="product-grid" id="Producto8">
            <div class="product-image" id='Imagen8'>
                <span class="product-new-label">Oferta</span>
                <span class="product-discount-label">20%</span>
            </div>
            <div class="product-content" id='Contenido1'>
                <div class="price">$16.00
                    <span>$20.00</span>
                </div>
                <a class="add-to-cart" href="">+ Add To Cart</a>
            </div>
        </div>
        <div class="product-grid" id="Producto9">
            <div class="product-image" id='Imagen9'>
                <span class="product-new-label">Oferta</span>
                <span class="product-discount-label">20%</span>
            </div>
            <div class="product-content" id='Contenido1'>
                <div class="price">$16.00
                    <span>$20.00</span>
                </div>
                <a class="add-to-cart" href="">+ Add To Cart</a>
            </div>
        </div>
        <div class="product-grid" id="Producto10">
            <div class="product-image" id='Imagen10'>
                <span class="product-new-label">Oferta</span>
                <span class="product-discount-label">20%</span>
            </div>
            <div class="product-content" id='Contenido1'>
                <div class="price">$16.00
                    <span>$20.00</span>
                </div>
                <a class="add-to-cart" href="">+ Add To Cart</a>
            </div>
        </div>
        <div class="product-grid" id="Producto11">
            <div class="product-image" id='Imagen11'>
                <span class="product-new-label">Oferta</span>
                <span class="product-discount-label">20%</span>
            </div>
            <div class="product-content" id='Contenido1'>
                <div class="price">$16.00
                    
                </div>
           
            </div>
        </div>

        <div class="product-grid" id="Producto12">
            <div class="product-image" id='Imagen12'>
                <span class="product-new-label">Oferta</span>
                <span class="product-discount-label">20%</span>
            </div>
            <div class="product-content" id='Contenido1'>
                <div class="price">$16.00
                    <span>$20.00</span>
                </div>
                <a class="add-to-cart" href="">+ Add To Cart</a>
            </div>
        </div>
        <div class="product-grid" id="Producto13">
            <div class="product-image" id='Imagen13'>
                <span class="product-new-label">Oferta</span>
                <span class="product-discount-label">20%</span>
            </div>
            <div class="product-content" id='Contenido1'>
                <div class="price">$16.00
                    <span>$20.00</span>
                </div>
                <a class="add-to-cart" href="">+ Add To Cart</a>
            </div>
        </div>
        <div class="product-grid" id="Producto14">
            <div class="product-image" id='Imagen14'>
                <span class="product-new-label">Oferta</span>
                <span class="product-discount-label">20%</span>
            </div>
            <div class="product-content" id='Contenido1'>
                <div class="price">$16.00
                    <span>$20.00</span>
                </div>
                <a class="add-to-cart" href="">+ Add To Cart</a>
            </div>
        </div>
        <div class="product-grid" id="Producto15">
            <div class="product-image" id='Imagen15'>
            </div>
            <div class="product-content" id='Contenido1'>
                <div class="price">
                </div>
            </div>
        </div>
    </div>

<div id="divTotal">
    <p align="center"><b>Carrito de la compra  <img src="MetaforaCarrito.png" width="20" height="20" > </b></p>
    <table id="tablaTotal" name="factura" style="width:80%; "></table>
    <p id="Facturafinal"></p>
            <a id="Finalizarcompra" style="display:none; font-family:Montserrat" href="destino.html" onclick="enviardatos()">Finalizar Compra</a>
</div>
</div>
</html>